/class name			:class_name			:class
css selector		:css	 
id					:id	 
link text			:link_text			:link
name				:name	 
partial link text	:partial_link_text	 
tag name			:tag_name	 
xpath				:xpath/

#BROWSER: FIREFOX
require "rubygems"
require "selenium-webdriver"
 browser = Selenium::WebDriver.for :firefox
  browser.get "https://login.microsoftonline.com/login.srf?wa=wsignin1.0&wtrealm=https%3a%2f%2flogin.windows.net%2f&wreply=https%3a%2f%2flogin.windows.net%2frhadev.onmicrosoft.com%2fwsfederation&wctx=3wEBDFdzRmVkZXJhdGlvbgENVXNlck9ubHlUb2tlbgEWcmhhZGV2Lm9ubWljcm9zb2Z0LmNvbQEBAQZzYW1sMjAAAAEBJWh0dHBzOi8vcmhhZGV2Lm9ubWljcm9zb2Z0LmNvbS9yaGF3ZWIAAAEBAQxyZXBseWFkZHJlc3MBHWh0dHBzOi8vcmhhLmF6dXJld2Vic2l0ZXMubmV0AQUBAnJjARZybT0wJmlkPXBhc3NpdmUmcnU9JTJmAQ9saW1pdF90b2tlbnNpemUBBUZhbHNlAQtpbnRlcmFjdGl2ZQEEVHJ1ZQEPRm9yY2VGcmVzaExvZ2luAQVGYWxzZQEJc2Vzc2lvbklkASRjODA0ZTkyYi04YTc5LTQ0N2QtYjYxZi00Y2ZjOWExYWVhZjTt0&wp=MBI_FED_SSL&id="
  #browser.window.resize_to(1680,1050)
  #driver.manage.timeouts.implicit_wait = 10
   browser.current_url
	browser.title

	#Login screen
		browser.find_element(id: "cred_userid_inputtext").send_keys "rhadevadmin@rhadev.onmicrosoft.com"
		browser.find_element(id: "cred_password_inputtext").send_keys "RHAdev989"
		browser.find_element(id: "cred_sign_in_button").click
		sleep(1)
		browser.find_element(id: "cred_sign_in_button").click

	#Navigate to the System Configuration page, clicks Services on left nav, and then click Add Service button
		#Clicks System Config
			browser.find_element(link_text: "System Configuration").click
		#Clicks Services on left Nav
			browser.find_element(link_text: "Services").click
		#Clicks Add Service
			browser.find_element(xpath: "/html/body/div/div[2]/div/div[2]/div/div[3]/a").click

	#Fill in Service data to add and save.
		#Entering in data
			browser.find_element(id: "ServiceModel_Name").send_keys "AddedByAutomationService1" #name
			browser.find_element(xpath: "/html/body/div/div[2]/div/form/section[1]/div[1]/div[2]/div/div/div[1]").click #service category drop down
				browser.find_element(css: "body > div > div.page-content > div > form > section:nth-child(2) > div:nth-child(1) > div.form-container.col-sm-4 > div > div > div.selectize-input.items.not-full.has-options > input").send_keys "eye" #enters a selection
					browser.find_element(css: "body > div > div.page-content > div > form > section:nth-child(2) > div:nth-child(1) > div.form-container.col-sm-4 > div > div > div.selectize-input.items.not-full.has-options > input").send_keys :return #selects the selection
		
			#Need to double click for field focus on this field.
			browser.find_element(id: "ServiceModel_UsualCharge").click #Field focus usual charge amount
			browser.find_element(id: "ServiceModel_UsualCharge").click #Field focus usual charge amount
				browser.find_element(id: "ServiceModel_UsualCharge").send_keys "500" #enters usual charge amount
			browser.find_element(id: "ServiceModel_HCPCS").send_keys "HCPCSauto" #HCPCS field
			browser.find_element(id: "ServiceModel_Modifier").send_keys "Modauto" #Modifier field
			
			browser.find_element(id: "ServiceModel_Effective_To").click
				browser.find_element(id: "ServiceModel_Effective_To").send_keys "12/30/2020"
				#browser.find_element(xpath: "/html/body/div[2]/div[1]/table/tbody/tr[4]/td[6]").click #Chooses today
			browser.find_element(id: "ServiceModel_Effective_From").click #Effective from calendar
				browser.find_element(id: "ServiceModel_Effective_From").send_keys "01/01/2015"
				#browser.find_element(xpath: "/html/body/div[2]/div[1]/table/tbody/tr[4]/td[5]").click #Chooses today

			
			#Uncomment below line if changing BILL TYPE to "Inpatient"; otherwise, it will default to "Outpatient"
				#browser.find_element(xpath: "/html/body/div/div[2]/div/form/section[1]/div[3]/div[1]/div/div[1]/label/span").click

			browser.find_element(xpath: "/html/body/div/div[2]/div/form/section[1]/div[3]/div[2]/div/div[1]/label/span").click #Revenue type revenue selections
				browser.find_element(xpath: "/html/body/div/div[2]/div/form/section[1]/div[3]/div[2]/div/div[2]/label/span").click #Shadow option
					browser.find_element(xpath: "/html/body/div/div[2]/div/form/section[1]/div[3]/div[2]/div/div[3]/label/span").click #NonBillable option
			browser.find_element(xpath: "/html/body/div/div[2]/div/form/section[1]/div[3]/div[2]/div/div[1]/label/span").click #Clicks "FFS" again
			
	#P & L and Balance Sheet Mapping
			browser.find_element(xpath: "/html/body/div/div[2]/div/form/section[1]/div[4]/div[1]/div/div/div[1]/input").click #P&L - Department drop down
				browser.find_element(css: "body > div > div.page-content > div > form > section:nth-child(2) > div:nth-child(5) > div:nth-child(1) > div > div > div.selectize-input.items.not-full.has-options > input").send_keys "234" #enters a selection
					browser.find_element(css: "body > div > div.page-content > div > form > section:nth-child(2) > div:nth-child(5) > div:nth-child(1) > div > div > div.selectize-input.items.not-full.has-options > input").send_keys :return #selects the selection

			browser.find_element(xpath: "/html/body/div/div[2]/div/form/section[1]/div[4]/div[2]/div/div/div[1]").click #P&L - Root Account drop down
				browser.find_element(css: "body > div > div.page-content > div > form > section:nth-child(2) > div:nth-child(5) > div:nth-child(2) > div > div > div.selectize-input.items.not-full.has-options.focus.input-active.dropdown-active > input[type='text']").send_keys "4323" #enters a selection
					browser.find_element(css: "body > div > div.page-content > div > form > section:nth-child(2) > div:nth-child(5) > div:nth-child(2) > div > div > div.selectize-input.items.not-full.has-options.focus.input-active.dropdown-active > input[type='text']").send_keys :return #selects the selection

			browser.find_element(xpath: "/html/body/div/div[2]/div/form/section[1]/div[4]/div[3]/div/div/div[1]/input").click #P&L - Product line drop down
				browser.find_element(css: "body > div > div.page-content > div > form > section:nth-child(2) > div:nth-child(5) > div:nth-child(3) > div > div > div.selectize-input.items.not-full.has-options > input").send_keys "432" #enters a selection
					browser.find_element(css: "body > div > div.page-content > div > form > section:nth-child(2) > div:nth-child(5) > div:nth-child(3) > div > div > div.selectize-input.items.not-full.has-options > input").send_keys :return #selects the selection

			browser.find_element(xpath: "/html/body/div/div[2]/div/form/section[1]/div[4]/div[4]/div/div/div[1]/input").click #P&L - Service line drop down
				browser.find_element(css: "body > div > div.page-content > div > form > section:nth-child(2) > div:nth-child(5) > div:nth-child(4) > div > div > div.selectize-input.items.not-full.has-options > input[type='text']").send_keys "3442" #enters a selection
					browser.find_element(css: "body > div > div.page-content > div > form > section:nth-child(2) > div:nth-child(5) > div:nth-child(4) > div > div > div.selectize-input.items.not-full.has-options > input[type='text']").send_keys :return #selects the selection

			browser.find_element(xpath: "/html/body/div/div[2]/div/form/section[1]/div[5]/div[1]/div/div/div[1]/input").click #Balance Sheet - Department line drop down
				browser.find_element(css: "body > div > div.page-content > div > form > section:nth-child(2) > div:nth-child(7) > div:nth-child(1) > div > div > div.selectize-input.items.not-full.has-options > input[type='text']").send_keys "11" #enters a selection
					browser.find_element(css: "body > div > div.page-content > div > form > section:nth-child(2) > div:nth-child(7) > div:nth-child(1) > div > div > div.selectize-input.items.not-full.has-options > input[type='text']").send_keys :return #selects the selection

			browser.find_element(xpath: "/html/body/div/div[2]/div/form/section[1]/div[5]/div[2]/div/div/div[1]/input").click #Balance Sheet - Root account drop down
				browser.find_element(css: "body > div > div.page-content > div > form > section:nth-child(2) > div:nth-child(7) > div:nth-child(2) > div > div > div.selectize-input.items.not-full.has-options > input[type='text']").send_keys "1212" #enters a selection
					browser.find_element(css: "body > div > div.page-content > div > form > section:nth-child(2) > div:nth-child(7) > div:nth-child(2) > div > div > div.selectize-input.items.not-full.has-options > input[type='text']").send_keys :return #selects the selection

			browser.find_element(xpath: "/html/body/div/div[2]/div/form/section[1]/div[5]/div[3]/div/div/div[1]/input").click #Balance Sheet - Product line drop down
				browser.find_element(css: "body > div > div.page-content > div > form > section:nth-child(2) > div:nth-child(7) > div:nth-child(3) > div > div > div.selectize-input.items.not-full.has-options > input[type='text']").send_keys "13" #enters a selection
					browser.find_element(css: "body > div > div.page-content > div > form > section:nth-child(2) > div:nth-child(7) > div:nth-child(3) > div > div > div.selectize-input.items.not-full.has-options > input[type='text']").send_keys :return #selects the selection

			browser.find_element(xpath: "/html/body/div/div[2]/div/form/section[1]/div[5]/div[4]/div/div/div[1]/input").click #Balance Sheet - Service line drop down
				browser.find_element(css: "body > div > div.page-content > div > form > section:nth-child(2) > div:nth-child(7) > div:nth-child(4) > div > div > div.selectize-input.items.not-full.has-options > input[type='text']").send_keys "14" #enters a selection
					browser.find_element(css: "body > div > div.page-content > div > form > section:nth-child(2) > div:nth-child(7) > div:nth-child(4) > div > div > div.selectize-input.items.not-full.has-options > input[type='text']").send_keys :return #selects the selection

	#Billing Rules
			browser.find_element(xpath: "/html/body/div/div[2]/div/form/section[2]/div[1]/div/div/div[1]/label/span").click #Rule type selections
				browser.find_element(xpath: "/html/body/div/div[2]/div/form/section[2]/div[1]/div/div/div[2]/label/span").click #Event option
					browser.find_element(xpath: "/html/body/div/div[2]/div/form/section[2]/div[1]/div/div/div[3]/label/span").click #PerDiem option
			browser.find_element(xpath: "/html/body/div/div[2]/div/form/section[2]/div[1]/div/div/div[1]/label/span").click #Clicks "Time" again

	#Billing Frequency Limits - THIS WAS REMOVED FROM THE ADD SERVICE SCREEN
			#browser.find_element(id: "min-units").click #Min units field focus 
				#browser.find_element(id: "min-units").send_keys "25" #Enters Min units
			#browser.find_element(id: "max-units").click #Max units field focus
				#browser.find_element(id: "max-units").send_keys "95" #Enters Max units
			#browser.find_element(id: "billing-limits").click #Puts focus a field
			
			browser.find_element(id: "billing-limits").click #Field focus for billing frequencies
			browser.find_element(id: "billing-limits").click #Field focus for billing frequencies
				browser.find_element(id: "billing-limits").send_keys "14" #enters a selection
					browser.find_element(id: "billing-limits").send_keys :return #selects the selection
			#browser.find_element(xpath: "/html/body/div/div[2]/div/form/section[2]/div[2]/div[3]/div/div/div[1]").click #Per drop down
			browser.find_element(id: "add-frequency").click #Clicks "Apply Frequency Limits button"
			
	#Define Measure
			browser.find_element(id: "ServiceModel_NumberOfUnits").click #Number of units field focus 
				browser.find_element(id: "ServiceModel_NumberOfUnits").send_keys "1000" #Enters Min units
			browser.find_element(id: "ServiceModel_Duration").click #Duration (minutes) field focus
				browser.find_element(id: "ServiceModel_Duration").send_keys "5" #Enters duration minutes units
			browser.find_element(id: "ServiceModel_DurationFloor").click #Duration Floor (minutes) field focus
				browser.find_element(id: "ServiceModel_DurationFloor").send_keys "15" #Enters duraction floor units
			browser.find_element(id: "ServiceModel_DurationCeiling").click #Duration Ceiling (minutes) field focus
				browser.find_element(id: "ServiceModel_DurationCeiling").send_keys "25" #Enters duration ceiling units
	
	#Request Start and End Time (By default, switch is NO - Comment the below line out if you want this to be true)
			browser.find_element(xpath: "//*[@id='model_time']/div/div/label[2]/span").click #Switches to YES

	#Authorization Rules (By default, switch is NO - Comment any of the below lines out if you want this to be true)
			browser.find_element(xpath: "//*[@id='bundling_vue']/div[1]/div[1]/div/label[2]/span").click #Required authorization; switches to YES
				browser.find_element(xpath: "//*[@id='bundling_vue']/div[2]/div/div/label[2]/span").click #Requiree Referral for authorization; switches to YES
					browser.find_element(xpath: "/html/body/div/div[2]/div/form/section[3]/div[2]/div/div/label[2]/span").click #Requires Diagnosis; switches to YES
	#Authorization Type
			browser.find_element(xpath: "//*[@id='bundling_vue']/div[1]/div[2]/div[2]/label/span").click #Sets to "Unmanaged" which lights up "Allow Bundle Authorizations"
				#Allow Bundled Authorization switch - By default, it's NO - Comment the below line out if wanting to keep NO selected
				browser.find_element(xpath: "//*[@id='bundling_vue']/div[2]/div[2]/div/div/label[2]/span").click #Switches "Allow Bundled Authorization" to YES

	#Enforce (under Authorization Rules)
			browser.find_element(id: "enforcement-limit").click #Limit field focus 
				browser.find_element(id: "enforcement-limit").send_keys "35" #Enters limit amount
			browser.find_element(xpath: "/html/body/div/div[2]/div/form/section[3]/div[3]/div[2]/div/div/div[1]/div").click #Per drop down
				#browser.find_element(css: "body > div > div.page-content > div > form > section:nth-child(3) > div:nth-child(4) > div:nth-child(3) > div > div > div.selectize-input.items.has-options.full.has-items").send_keys "14" #enters a selection
					#browser.find_element(css: "body > div > div.page-content > div > form > section:nth-child(3) > div:nth-child(4) > div:nth-child(3) > div > div > div.selectize-input.items.has-options.full.has-items").send_keys :return #selects the selection
			browser.find_element(id: "add-limit").click #Clicks "Apply Frequency Limits button"
	
	#Clinical Rules (By default, all switches are set to NO)
			browser.find_element(xpath: "/html/body/div/div[2]/div/form/section[4]/div[1]/div[1]/div/label[2]/span").click #QA Review Required; switches to YES
				browser.find_element(xpath: "/html/body/div/div[2]/div/form/section[4]/div[2]/div[1]/div/label[2]/span").click #Entry for Multiple Staff; switches to YES
					browser.find_element(xpath: "/html/body/div/div[2]/div/form/section[4]/div[3]/div[1]/div/label[2]/span").click #Entry for Multiple Clients; switches to YES
						browser.find_element(xpath: "//*[@id='services_vue']/div[1]/div[1]/div/label[2]/span").click #Attending Provider Required; switches to YES
						browser.find_element(xpath: "//*[@id='services_vue']/div[2]/div[1]/div/div/div/label[2]/span").click #Provisionally Licensed OK; switches to YES
							browser.find_element(xpath: "/html/body/div/div[2]/div/form/section[4]/div[2]/div[2]/div/label[2]/span").click #Calocus / Locus Required; switches to YES
								browser.find_element(xpath: "/html/body/div/div[2]/div/form/section[4]/div[3]/div[2]/div/label[2]/span").click #Link to PCP or SP; switches to YES
									browser.find_element(xpath: "//*[@id='services_vue']/div[1]/div[2]/div/label[2]/span").click #Note Required; switches to YES
								#If above line is YES, Note Type field appears
									browser.find_element(xpath: "//*[@id='services_vue']/div[2]/div[2]/div/div/div/div[1]/label/span").click #PIE note type
									browser.find_element(xpath: "//*[@id='services_vue']/div[2]/div[2]/div/div/div/div[2]/label/span").click #NB note type
									browser.find_element(xpath: "//*[@id='services_vue']/div[2]/div[2]/div/div/div/div[3]/label/span").click #EM note type
				#Encounter Type (By default, set to "FTF")
					#browser.find_element(xpath: "/html/body/div/div[2]/div/form/section[4]/div[1]/div[2]/div[2]/label/span").click
						#browser.find_element(xpath: "/html/body/div/div[2]/div/form/section[4]/div[1]/div[2]/div[1]/label/span").click

	#Rounding Rules
		#Service Type
			browser.find_element(xpath: "/html/body/div/div[2]/div/form/section[5]/div/div[1]/div/div[1]/label/span").click #Unit option
				browser.find_element(xpath: "/html/body/div/div[2]/div/form/section[5]/div/div[1]/div/div[2]/label/span").click #Time option
		#Always Round
			browser.find_element(xpath: "/html/body/div/div[2]/div/form/section[5]/div/div[2]/div/div[1]/label/span").click #Up option
				browser.find_element(xpath: "/html/body/div/div[2]/div/form/section[5]/div/div[2]/div/div[2]/label/span").click #Down option


sleep(10)

			#Saves the Service
				browser.find_element(xpath: "/html/body/div[1]/div[2]/div/form/div/ul/li[2]/button").click

=begin

	#wait.until(ExpectedConditions.elementToBeClickable(By.class "selectize-control"));
	#/WebDriverWait wait = new WebDriverWait(webDriver, timeoutInSeconds);
	#wait.until(ExpectedConditions.visibilityOfElementLocated(By.class "selectize-control"));/
	#browser.find_element(link_text: "Images").click
	#browser.find_elements(tag_name: "img").size

		#Logout
			browser.find_element(id: "signout-icon").click

=end

browser.close


